swagger: '2.0'
x-stoplight:
  id: opbcj7fqgxaf4
info:
  title: Files-API
  version: '1.0'
host: 'localhost:5000'
schemes:
  - http
produces:
  - application/json
consumes:
  - application/json
paths:
  '/files-api/{id}':
    parameters:
      - type: string
        name: id
        in: path
        required: true
        description: Post ID (GET) or File ID (DELETE)
    get:
      summary: Returns the list of files attached to a post.
      responses:
        '200':
          description: Successful
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  type: object
                  properties:
                    file_name:
                      type: string
                    id:
                      type: integer
                    path:
                      type: string
                    post_id:
                      type: integer
            x-examples:
              example-1:
                data:
                  - file_name: 1685907898_5274.txt
                    id: 1
                    path: uploads/documents
                    post_id: 123
          examples:
            example-200-1:
              data:
                - file_name: 1685907898_5274.txt
                  id: 1
                  path: uploads/documents
                  post_id: 123
                - file_name: 1685907898_5275.txt
                  id: 2
                  path: uploads/documents
                  post_id: 123
        '403':
          description: Forbidden
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  error:
                    type: string
            x-examples:
              example-1:
                data:
                  error: Invalid User
          examples:
            example-403:
              data:
                error: Invalid User
        '500':
          description: Internal Server Error
          schema:
            type: object
            properties:
              error:
                type: string
            x-examples:
              example-1:
                error: 'Something went wrong, please contact admin support'
          examples:
            example-500:
              error: 'Something went wrong, please contact admin support'
      operationId: get-file-by-post-id
      description: Returns the list of files attached to a post.
      parameters:
        - type: string
          in: header
          name: auth-token
          description: Authentication Token
    delete:
      summary: Delete file.
      operationId: delete-file-by-id
      responses:
        '200':
          description: OK
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  message:
                    type: string
            x-examples:
              example-1:
                data:
                  message: File deleted successfully
          examples:
            example-200:
              data:
                message: File deleted successfully
        '400':
          description: Bad Request
          schema:
            type: object
            properties:
              error:
                type: string
            x-examples:
              example-1:
                error: 'Missing required parameter: file_id'
          examples:
            example-400:
              error: 'Missing required parameter: file_id'
        '403':
          description: Forbidden
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  error:
                    type: string
            x-examples:
              example-1:
                data:
                  error: Invalid User
          examples:
            example-403:
              data:
                error: Invalid User
        '404':
          description: Not Found
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  error:
                    type: string
            x-examples:
              example-1:
                data:
                  error: File not found
          examples:
            example-404:
              data:
                error: File not found
        '500':
          description: Internal Server Error
          schema:
            type: object
            properties:
              error:
                type: string
            x-examples:
              example-1:
                error: 'Something went wrong, please contact admin support'
          examples:
            example-500:
              error: 'Something went wrong, please contact admin support'
      description: Deletes a file attached to a post based on its Id.
      parameters:
        - type: string
          in: header
          name: auth-token
          description: Authentication Token
  /files-api:
    post:
      summary: Attach files to a post based on the Post Id.
      operationId: upload-file
      responses:
        '201':
          description: Successful
          schema:
            type: object
            x-examples:
              example-1:
                data:
                  - id:
                      file_name: 1685907898_5274.txt
                      id: 1
                      path: uploads/documents
                      post_id: 123
            properties:
              data:
                type: array
                items:
                  type: object
                  properties:
                    '{id}':
                      type: object
                      properties:
                        file_name:
                          type: string
                        id:
                          type: integer
                        path:
                          type: string
                        post_id:
                          type: integer
          examples:
            example-201:
              data:
                - '1':
                    file_name: 1685907898_5274.txt
                    id: 1
                    path: uploads/documents
                    post_id: 123
                - '2':
                    file_name: 1685907898_5274.txt
                    id: 2
                    path: uploads/documents
                    post_id: 123
        '400':
          description: Bad Request
          schema:
            type: object
            x-examples:
              example-1:
                txt_com_palavrao.txt: File content has bad words
            properties:
              filename.extension:
                type: string
              post_id:
                type: string
              files:
                type: string
          examples:
            example-400-1:
              fileWithBadWord.txt: File content has bad words
            example-400-2:
              filename.invalidExtension: File type is not allowed
            example-400-3:
              post_id: This is a required field
            example-400-4:
              files: This is a required field
            example-400-5:
              files: It must be a file
        '403':
          description: Forbidden
          schema:
            type: object
            properties:
              data:
                type: object
                properties:
                  error:
                    type: string
            x-examples:
              example-1:
                data:
                  error: Invalid User
          examples:
            example-403:
              data:
                error: Invalid User
      description: Attach files to a post based on the Post Id.
      consumes:
        - multipart/form-data
      parameters:
        - in: formData
          type: array
          name: files
          description: File list
          items:
            type: number
          required: true
        - in: formData
          type: number
          name: post_id
          description: Post ID
          required: true
        - type: string
          in: header
          description: Authentication Token
          name: auth-token
    parameters: []
definitions: {}
